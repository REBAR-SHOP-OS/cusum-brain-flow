
# تغییر فرآیند تولید پست Pixel: یکی‌یکی با تایید کاربر

## وضعیت فعلی
در حال حاضر وقتی کاربر درخواست تولید پست می‌دهد، هر 5 پست (کپشن + تصویر) به صورت همزمان و یکجا ساخته و نمایش داده می‌شوند.

## تغییر پیشنهادی
پست‌ها یکی‌یکی ساخته شوند. بعد از نمایش هر پست، کاربر باید آن را تایید کند تا پست بعدی ساخته شود.

### فلوی جدید:
1. کاربر می‌گوید "برای امروز پست بساز"
2. بک‌اند کپشن و تصویر فقط اسلات 1 (06:30 AM) را می‌سازد و برمی‌گرداند
3. کاربر پست را می‌بیند و تایید می‌کند
4. اسلات 2 (07:30 AM) ساخته می‌شود
5. تکرار تا اسلات 5

---

## جزئیات فنی

### 1. فایل `supabase/functions/ai-agent/index.ts`
- پارامتر جدید `pixelSlot` به بدنه درخواست اضافه می‌شود (مقدار پیش‌فرض: 1)
- به جای تولید 5 پست همزمان، فقط 1 پست برای اسلات مشخص‌شده تولید می‌شود
- پرامپت سیستمی تغییر می‌کند تا فقط 1 پست بسازد
- تصویر فقط برای همان 1 پست ساخته می‌شود
- در پاسخ، فیلد `nextSlot` اضافه می‌شود تا فرانت بداند اسلات بعدی چیست (یا `null` اگر آخرین پست بود)

### 2. فایل `src/lib/agent.ts`
- فیلد `nextSlot` به `AgentResponse` اضافه می‌شود

### 3. فایل `src/pages/AgentWorkspace.tsx`
- state جدید: `pendingPixelSlot` (شماره اسلات بعدی) و `pixelDate` (تاریخ درخواستی)
- وقتی پاسخ Pixel دارای `nextSlot` باشد، دکمه "تایید و ادامه" نمایش داده می‌شود
- کلیک روی دکمه تایید، پیام خودکار برای اسلات بعدی ارسال می‌کند
- بعد از اسلات 5، پیام "همه پست‌ها تکمیل شد" نمایش داده می‌شود

### 4. فایل `src/components/chat/ChatThread.tsx` (یا کامپوننت جدید)
- دکمه تایید ("Approve & Next" / "تایید و ساخت بعدی") بعد از هر پست Pixel نمایش داده می‌شود
- دکمه "بازسازی" هم برای ساخت مجدد همان اسلات باقی می‌ماند
