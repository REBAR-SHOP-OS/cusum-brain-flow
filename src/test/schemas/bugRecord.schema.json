{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "BugRecord",
  "description": "Structured bug report from automated ERP testing",
  "type": "object",
  "required": ["bug_id", "title", "module", "severity", "priority", "type", "steps_to_repro", "expected", "actual", "status", "first_seen_run_id"],
  "properties": {
    "bug_id": {
      "type": "string",
      "description": "Stable hash from module + title + endpoint/selector"
    },
    "title": {
      "type": "string",
      "maxLength": 120
    },
    "module": {
      "type": "string",
      "enum": ["dashboard", "customers", "crm", "orders", "deliveries", "production", "machines", "timeclock", "social", "inventory", "team"]
    },
    "severity": {
      "type": "string",
      "enum": ["S0", "S1", "S2", "S3"],
      "description": "S0=blocker, S1=critical, S2=major, S3=minor"
    },
    "priority": {
      "type": "string",
      "enum": ["P0", "P1", "P2", "P3"]
    },
    "type": {
      "type": "string",
      "enum": ["UI", "API", "Data", "Permissions", "Performance", "Reliability"]
    },
    "steps_to_repro": {
      "type": "array",
      "items": { "type": "string" },
      "minItems": 1
    },
    "expected": { "type": "string" },
    "actual": { "type": "string" },
    "evidence": {
      "type": "object",
      "properties": {
        "screenshot_path": { "type": "string" },
        "video_path": { "type": "string" },
        "console_logs": { "type": "string" },
        "network_trace": { "type": "string" },
        "api_response_snippet": { "type": "string" }
      }
    },
    "suspected_root_cause": { "type": "string" },
    "workaround": { "type": "string" },
    "first_seen_run_id": { "type": "string" },
    "last_seen_run_id": { "type": "string" },
    "status": {
      "type": "string",
      "enum": ["new", "known", "regression", "fixed", "fixed_unverified"]
    }
  }
}
